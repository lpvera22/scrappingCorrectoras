from pysafebrowsing import SafeBrowsing
import os

from functools import partial

from dotenv import load_dotenv

load_dotenv()


def isMalicious(url, r):
    return r[url]['malicious']


def checkAll(df):
    s = SafeBrowsing(os.environ['KEY'])
    r = s.lookup_urls(df['url'].to_list())
    isM = partial(isMalicious, r=r)
    df['malicious'] = df['url'].apply(isM)
    return df


if __name__ == '__main__':

    print(os.environ['KEY'])
